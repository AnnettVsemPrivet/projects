# pattern_recognition
Задача - выделение паттернов на биржевом рынке и прогноз временного отрезка следующего за паттерном. 
Для решения задачи составлены следующие модули:
- preprocessing.py: используется для подготовки обучающей выборки
- clustering.py: используется для обучения и сохранения модели кластеризации KShape
- predicting.py: используется для обучения и предсказания модели прогнозирования LSTM

В качестве примера можно посмотреть ноутбук clustering_n_predicting.ipynb, 
в котором берутся поминутные данные по акциям Сбербанка за 2021г, из датасета выделяются 30-минутные отрезки. 
По 30-минутным периодам обучается модель кластеризации ks_trained_4.hdf5, по графикам и СКО определяем какие кластеры
имеют максимально схожую структуру. Затем через данную модель пропускается более обширная выборка для предсказания кластеров.
Выбираем любой кластер, и по собранным обучающим данным тренируем модель прогнозирования. В конце можно посмотреть на результаты прогноза по R2 и MSE.
В итоге, на примере одного кластера, можно увидеть что модель обучилась правильно показывать траекторию движения на ближайшие 10 минут, но 
небольшие отклонения в 1-2 минуты она предсказать не смогла.
